{% extends "base.html" %}

{% block title %} {{ page_title }} {% endblock %}

{% block header %}{% endblock %}

{% block content %}

<br>
<ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="{% url 'movies' %}">Movies' Home</a>
  </li>
  <li class="breadcrumb-item active">Details</li>
</ol>

    <!-- Portfolio Item Row -->
    <div class="row">

      <div id="cover_back" class="col-md-4">
        <img id="cover_detail" class="img-fluid" src="{{ page_content.cover.url }}" alt="">
        {% if user.is_authenticated %}
        <table>
          <h5 class="my-2">&nbsp;&nbsp;Votre avis compte.</h5>
            <tr>
            </tr>
            <tr>
                <td>
                    <!-- Form for likes -->
                    <form action="" id="like_dislike" name="theForm" method="POST">
                        {% csrf_token %}
                        <!-- <button onclick="document.getElementById('like_dislike').submit();">like {{ form_view_avi.likes }}</button>
                        <button onclick="document.getElementById('like_dislike').submit();">dislike {{ form_view_avi.dislikes }}</button>  -->

                        <button class="btn btn-sm" type="submit" onclick="theForm()">
                            <!-- {{ form_view_avi.likes }} -->
 
                            <input aria-describedby="inputGroup-sizing-sm" style="background-color:rgb(29, 83, 230);color: #fff;border-color: #112025;border-radius: 10px;"
                                    class="form-control"
                                    type="submit"
                                    name="likes"
                                    value=  "Likes {{ all_likes }} ">
                        </button>
                        
                        <button class="btn btn-sm"  type="submit" onclick="theForm()">
                            <!-- {{ form_view_avi.dislikes }} -->
                            <input aria-describedby="inputGroup-sizing-sm" style="background-color:#ba2121;color: #fff;border-color: #112025;border-radius: 10px;"
                                    class="form-control"
                                    type="submit"
                                    name="dislikes"
                                    value="Dislikes {{ all_dislikes }} ">
                        </button>

                    </form>
                    <!-- Scripts for likes -->
                    <script>
                        function theForm(){
                            document.theForm.submit();
                        }
                    </script>
                </td>
            </tr>
        </table>
        {% endif %}
      </div>

      <div class="col">
        <div class="card h-100">
          <h5 class="card-header"> {{ page_content }}[{{ page_content.resolution }}] <br> Seulement à <i>{{ page_content.prix }}</i> FBU</h5>
          <div class="card-body">
            <div class="display-5"><p>Description</p></div>
            <div class="font-italic">{{ page_content.description }}</div>
          </div>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <font size="2">Acteur &emsp;&emsp;&emsp; : {{ page_content.acteur }}</font>
            </li>
            <li class="list-group-item">
              <font size="2">Réalisateur &emsp; : {{ page_content.realisateur }}</font>
            </li>
            <li class="list-group-item">
              <font size="2">Studio &emsp;&emsp;&emsp; : {{ page_content.studio }} <br>
                Sortie en &emsp;&emsp; : {{ page_content.date|date:"Y" }} <br>
                Ajouté par&emsp;&emsp;: {{ page_content.user }}
              </font>
            </li>
            <li class="list-group-item">
              <form class="" action="index.html" method="post">
                <a href="#" class="btn btn-primary">Téléchargement Gratuit</a>
                <a id="acheter" href="#" class="btn btn-success">Télécharger Payant</a>
                <a id="valider" href="#" class="btn btn-success">Validation</a>
                <a id="telecharger" href="#" class="btn btn-success">Télécharger</a>
                <input class="form-control" style ="margin-top: 5px;" id="inputid" required type="text" placeholder="Numéro de comfirmation"/>
              </form>
            </li>
          </ul>
        </div>
      </div>

    </div>
    <!-- /.row -->
    <div class="row">

      <div class="col-lg-8 mb-4">
        {% if request.user.is_authenticated %}
        <h3>Lire les commentaires.</h3>
        <table>
            {% for com_list in comm_obj %}
            <tr>
              <td>
                
                  <i><b>{{ com_list.user }}</b>
                    <font size = "1">, le {{ com_list.date }}</font>
                    <br>&emsp;&emsp;{{ com_list.commentaire }}</i>
              </td>
            </tr>
            {% endfor %}
        </table>
        {% endif %}
      </div>

      <!-- Comment Form -->
      <div class="col-lg-8 mb-4">
        {% if request.user.is_authenticated %}
        <label>Votre commentaire compte.</label>
        <form action="" method="POST">
            {% csrf_token %}
            {{ form_view_comm.as_p }}
            <input type="submit" class="btn btn-dark" value="Commenter" />
        </form>
          
          {% else %}
          
          <i>Pour commenter, Vous devez vous connecter d'abord!</i>
          
          {% endif %}
      </div>

    </div>
<!-- Related Projects Row -->
<h3 class="my-4">Recherches associées:
  <h4><small>Ses nouveautés</small></h4>
</h3>
<div class="row">
  {% for assoc in associated_movies %}
  <div class="col-md-3 col-sm-6 mb-4">
    <a href="{% url 'details_app' assoc.slug %}">
      <!-- Photo size is 500 x 300 -->
      <img class="img-fluid" src="{{ assoc.cover.url }}" alt="{{ assoc.cover.titre }}" width="300px" height="100px"> 
    </a>
  </div>
  {% endfor %}
</div>
<!-- /.row -->

  {% endblock %}
